---
layout: layout
---
{% assign post = page %}
{% include interactions/vars.html %}

{% capture codetag %}<code{% endcapture %}
{% assign parts = page.content | split: codetag %}

{% if parts.size > 1 or page.archived_comments %}
  <link rel="stylesheet" href="{{ '/assets/pygments.css' | relative_url }}" />
{% endif %}
{% if post.archive %}
  <link rel="stylesheet" href="{{ '/assets/eras.css' | relative_url }}" />
{% endif %}
{% if post.header_background %}
<style>body { background-image: url('{{ post.header_background }}'); }</style>
{% endif %}

{% assign post_year = post.date | date: "%Y" | plus: 0 %}
{% include posts/era-vars.html %}

<article class="post h-entry{{ era_class }}">
  <header>
    <h2>
      <a href="{{ post.url }}" class="p-name u-url">
        {{ post.title }}
      </a>
    </h2>
    <div class="post-meta">
      <div class="post-meta-primary">
        {% assign read_time = post.content | number_of_words | divided_by:180 %}
        <time class="dt-published" datetime="{{post.date | date: "%Y-%m-%d"}}">{{ post.date | date:"%B %d %Y" }}</time>
        <span class="bullet">  &bull; </span>
        <span class="read-time">{% if read_time != 0 %}{{ read_time }}{% else %}1{% endif %} min read</span>
      </div>
      <div class="post-meta-secondary">
        {% include interactions/count.html %}
        {% include global/types.html %}
      </div>
    </div>
  </header>
{% assign cutoff_year = 2020 | plus: 0 %}
{% assign archive_check = post.archived | default: false %}
{% assign old_difference = cutoff_year | minus: post_year %}

{% if era_notice != "" %}
  <div class="archived-notice">{{ era_notice }}</div>
{% elsif archive_check or old_difference > 0 %}
  <div class="archived-notice">
    This post was published in {{ post_year }} and is kept here for reference. It may contain information that's outdated or inaccurate.
  </div>
{% endif %}

{% if era_class != "" %}
  <div class="era-fragment">
    <div class="era-fragment-header">
      <span class="era-fragment-domain">{{ era_label }}</span>
      {% if era_tagline != "" %}<span class="era-fragment-tagline">{{ era_tagline }}</span>{% endif %}
    </div>
    <div class="era-fragment-body e-content {% if post.archived %}archived{% endif %}">{{ content }}</div>
  </div>
{% else %}
  <div class="e-content {% if post.archived %}archived{% endif %}">{{ content }}</div>
{% endif %}

  {% if post.collection == 'cardboctober' %}
    {% capture cardboctober_footer %}{% include posts/cardboctober.html %}{% endcapture %}{{ cardboctober_footer | markdownify }}
  {% endif %}
  {% include interactions/syndication.html %}
</article>

{% include interactions/templates.html %}
{% include interactions/stream.html %}

<nav class="post-navigation">
  {% if page.previous %}
    <a href="{{ page.previous.url }}" class="prev-post" title="{{ page.previous.title }}">
      <span class="nav-label">← Previous</span>
      <span class="nav-title">{{ page.previous.title }}</span>
    </a>
  {% endif %}
  {% if page.next %}
    <a href="{{ page.next.url }}" class="next-post" title="{{ page.next.title }}">
      <span class="nav-label">Next →</span>
      <span class="nav-title">{{ page.next.title }}</span>
    </a>
  {% endif %}
</nav>

{% if post.content contains '<div data-src' %}
<script>
  const lazy_iframes = document.querySelectorAll('.iframe [data-src]');
  lazy_iframes.forEach(el => {
    el.addEventListener('click', e => {
      const iframe = document.createElement('iframe');
      iframe.width = el.clientWidth;
      iframe.height = el.clientHeight;
      iframe.classList = el.classList;
      iframe.classList.remove('placeholder');
      iframe.src = [el.dataset.src, 'autoplay=1'].join(el.dataset.src.includes('?') ? '&' : '?');
      
      el.replaceWith(iframe); 
    }, false)
  });
</script>
{% endif %}